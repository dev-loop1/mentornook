function handleAuthState(){const e=isAuthenticated(),t=document.querySelector(".main-header"),n=window.location.pathname.split("/").pop()||"index.html",o=["dashboard.html","profile_setup.html","my_profile.html","user_profile.html","connections.html"],l=["login.html","signup.html"];if(e){if(t&&t.classList.replace("logged-out","logged-in"),l.includes(n))return void(window.location.href="dashboard.html");if("index.html"===n)return void(window.location.href="dashboard.html");updateHeaderForLoggedInUser()}else{if(t&&t.classList.replace("logged-in","logged-out"),o.includes(n))return void(window.location.href="login.html");updateHeaderForLoggedOutUser()}}function updateHeaderForLoggedInUser(){const e=document.querySelector(".main-header .container nav");e&&(e.querySelector("#logout-button")||(e.innerHTML=`\n          <ul>\n              <li><a href="dashboard.html" class="${isActive("dashboard.html")}">Dashboard</a></li>\n              <li><a href="my_profile.html" class="${isActive("my_profile.html")}">My Profile</a></li>\n              <li><a href="connections.html" class="${isActive("connections.html")}">Connections</a></li>\n              <li><button id="logout-button" class="btn btn-secondary">Logout</button></li>\n          </ul>\n      `))}function updateHeaderForLoggedOutUser(){const e=document.querySelector(".main-header .container nav");e&&(e.querySelector(".btn-primary")?.href?.includes("signup.html")||(e.innerHTML='\n           <ul>\n               <li><a href="signup.html" class="btn btn-primary">Sign Up</a></li>\n               <li><a href="login.html" class="btn btn-secondary">Login</a></li>\n           </ul>\n       '))}function isActive(e){return window.location.pathname.endsWith(e)?"active":""}document.addEventListener("DOMContentLoaded",(()=>{const e=(new Date).getFullYear(),t=document.getElementById("current-year");t&&(t.textContent=e);const n=document.querySelector(".mobile-menu-toggle"),o=document.querySelector(".main-header nav");n&&o&&n.addEventListener("click",(()=>{o.classList.toggle("mobile-nav-active"),n.textContent=o.classList.contains("mobile-nav-active")?"✕":"☰"})),handleAuthState();const l=document.querySelector(".main-header");l&&l.addEventListener("click",(async e=>{if(e.target&&"logout-button"===e.target.id){e.target.disabled=!0,e.target.textContent="Logging out...";try{const e=await WorkspaceApi("/logout/","POST",null,!0);e.success||console.warn("Backend logout failed (maybe token was already invalid?):",e.error)}catch(e){console.error("Error during logout API call:",e)}finally{clearAuthInfo(),window.location.href="login.html"}}}))}));